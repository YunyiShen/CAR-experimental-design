library(ggplot2)
library(reshape2)
res_dir <- "./Res/init_200_stepsize_20_steps_50"
res_files <- list.files(res_dir, pattern = "csv$", full.names = T)
res_df <- lapply(res_files,read.csv)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert", "MGIG-uncert","Wishart-cert","Wishart-uncert")
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert", "MGIG-uncert","Wishart-cert","Wishart-uncert")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert", "MGIG-uncert","Wishart-cert","Wishart-uncert")
sample_size <- 200 + 0:50 * 20
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
plot_data <- merge(res_mean_long, res_hi_long)
plot_data <- merge(plot_data, res_lw_long)
View(plot_data)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior)) +
geom_line()
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line()
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi))
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.8)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.5)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3)
?geom_errorbar
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 1)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_abline(intercept = 0)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_hline(intercept = 0)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_hline(y = 0)
?geom_hline
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_hline(yintercept =  = 0)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_hline(yintercept =  0)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
geom_hline(yintercept =  0, lty = 2)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
xlab("Sample size")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
xlab("Sample size") +
ylab("log difference in Stein's loss to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#F0E442", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#E69F00", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#E69F00", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#56B4E9", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment")
ggsave("./Res/init_200_stepsize_20_steps_50/log_stein_diff.pdf",
width = 10, height = 8)
ggsave("./Res/init_200_stepsize_20_steps_50/log_stein_diff.pdf",
width = 10, height = 6, scale = 2)
ggsave("./Res/init_200_stepsize_20_steps_50/log_stein_diff.pdf",
width = 10, height = 6, scale = 0.5)
ggsave("./Res/init_200_stepsize_20_steps_50/log_stein_diff.pdf",
width = 10, height = 6, scale = 0.8)
library(ggplot2)
library(reshape2)
res_dir <- "./Res/init_200_stepsize_50_steps_40_lambda_kp1"
res_files <- list.files(res_dir, pattern = "csv$", full.names = T)
res_df <- lapply(res_files,read.csv)
res_mean <- sapply(res_df, colMeans)
res_df
res_files
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5"
)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5"
)
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5")
sample_size <- 200 + 0:40 * 50
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
head(res_mean_long)
substr(res_mean_long$prior,1,2)
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, length(res_mean_long$prior)-1, length(res_mean_long$prior)))
res_mean_long$model
substr(res_mean_long$prior, length(res_mean_long$prior)-1, length(res_mean_long$prior))
substr(res_mean_long$prior, length(res_mean_long$prior)-2, length(res_mean_long$prior))
substr(res_mean_long$prior, nchar(res_mean_long$prior)-2, nchar(res_mean_long$prior))
substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-2, nchar(as.character(res_mean_long$prior)))
substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1, nchar(as.character(res_mean_long$prior)))
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1, nchar(as.character(res_mean_long$prior))))
head(res_mean_long)
substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-1)
substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-2)
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_lw_long$prior <- res_mean_long$prior
res_lw_long$model <- res_mean_long$model
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
res_hi_long$prior <- res_mean_long$prior
res_hi_long$model <- res_mean_long$model
plot_data <- merge(res_mean_long, res_hi_long)
plot_data <- merge(plot_data, res_lw_long)
?facet_grid
?facet_wrap
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model)
View(res_hi)
View(res_hi_long)
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1,
nchar(as.character(res_mean_long$prior))))
res_mean_long$prior <- substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-2)
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_lw_long$prior <- res_mean_long$prior
res_lw_long$model <- res_mean_long$model
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
res_hi_long$prior <- res_mean_long$prior
res_hi_long$model <- res_mean_long$model
plot_data <- merge(res_mean_long, res_hi_long)
plot_data <- merge(plot_data, res_lw_long)
View(plot_data)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5"
)
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3",
"MGIG-cert-5", "MGIG-uncert-5",
"Wishart-cert-5","Wishart-uncert-5")
sample_size <- 200 + 0:40 * 50
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1,
nchar(as.character(res_mean_long$prior))))
res_mean_long$prior <- substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-2)
View(res_mean_long)
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_lw_long$prior <- res_mean_long$prior
res_lw_long$model <- res_mean_long$model
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
res_hi_long$prior <- res_mean_long$prior
res_hi_long$model <- res_mean_long$model
View(res_hi_long)
plot_data <- merge(res_mean_long, res_hi_long)
View(plot_data)
plot_data <- merge(plot_data, res_lw_long)
View(plot_data)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 1)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 3)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 1)
library(ggplot2)
library(reshape2)
res_dir <- "./Res/init_200_stepsize_50_steps_40_lambda_kp1"
res_files <- list.files(res_dir, pattern = "csv$", full.names = T)
res_df <- lapply(res_files,read.csv)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5"
)
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5")
sample_size <- 200 + 0:40 * 50
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1,
nchar(as.character(res_mean_long$prior))))
res_mean_long$prior <- substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-2)
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_lw_long$prior <- res_mean_long$prior
res_lw_long$model <- res_mean_long$model
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
res_hi_long$prior <- res_mean_long$prior
res_hi_long$model <- res_mean_long$model
plot_data <- merge(res_mean_long, res_hi_long)
plot_data <- merge(plot_data, res_lw_long)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 1)
res_dir <- "./Res/init_200_stepsize_50_steps_40_lambda_kp1"
res_files <- list.files(res_dir, pattern = "csv$", full.names = T)
res_df <- lapply(res_files,read.csv)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5"
)
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-uncert-5", "MGIG-ununcert-5",
"Wishart-uncert-5","Wishart-ununcert-5")
sample_size <- 200 + 0:40 * 50
library(ggplot2)
library(reshape2)
res_dir <- "./Res/init_200_stepsize_50_steps_40_lambda_kp1"
res_files <- list.files(res_dir, pattern = "csv$", full.names = T)
res_df <- lapply(res_files,read.csv)
res_mean <- sapply(res_df, colMeans)
colnames(res_mean) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3"
)
res_lw <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.025)
})
colnames(res_lw) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3")
res_hi <- sapply(res_df, function(w){
apply(as.matrix(w),2, quantile, probs = 0.925)
})
colnames(res_hi) <- c("MGIG-cert-1", "MGIG-uncert-1",
"Wishart-cert-1","Wishart-uncert-1",
"MGIG-cert-2", "MGIG-uncert-2",
"Wishart-cert-2","Wishart-uncert-2",
"MGIG-cert-3", "MGIG-uncert-3",
"Wishart-cert-3","Wishart-uncert-3")
sample_size <- 200 + 0:40 * 50
res_mean <- data.frame(sample_size=sample_size, res_mean)
res_lw <- data.frame(sample_size=sample_size, res_lw)
res_hi <- data.frame(sample_size=sample_size, res_hi)
res_mean_long <- melt(res_mean, id.vars="sample_size", value.name = "mean", variable.name = "prior")
res_mean_long$model <- paste0("Model",substr(res_mean_long$prior, nchar(as.character(res_mean_long$prior))-1,
nchar(as.character(res_mean_long$prior))))
res_mean_long$prior <- substr(res_mean_long$prior, 1,
nchar(as.character(res_mean_long$prior))-2)
res_lw_long <- melt(res_lw, id.vars="sample_size", value.name = "lw", variable.name = "prior")
res_lw_long$prior <- res_mean_long$prior
res_lw_long$model <- res_mean_long$model
res_hi_long <- melt(res_hi, id.vars="sample_size", value.name = "hi", variable.name = "prior")
res_hi_long$prior <- res_mean_long$prior
res_hi_long$model <- res_mean_long$model
plot_data <- merge(res_mean_long, res_hi_long)
plot_data <- merge(plot_data, res_lw_long)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 1)
ggsave("./Res/init_200_stepsize_20_steps_50/log_stein_diff.pdf",
width = 10, height = 6, scale = 0.8)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 3)
ggsave("./Res/init_200_stepsize_50_steps_40_lambda_kp1/log_stein_diff.pdf",
width = 10, height = 6, scale = 0.8)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 1)
ggsave("./Res/init_200_stepsize_50_steps_40_lambda_kp1/log_stein_diff.pdf",
width = 10, height = 6, scale = 0.8)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 2)
ggsave("./Res/init_200_stepsize_50_steps_40_lambda_kp1/log_stein_diff2.pdf",
width = 10, height = 6, scale = 0.8)
ggplot(data=plot_data, aes(x=sample_size, y = mean, color = prior, shape = prior)) +
geom_hline(yintercept =  0, lty = 2) +
geom_line() +
geom_errorbar(aes(ymin = lw, ymax = hi), alpha = 0.3, width = 5) +
scale_color_manual(values = c("#009E73", "#0072B2", "#D55E00", "#CC79A7")) +
xlab("Sample size") +
ylab("log Stein's loss difference to no experiment") +
facet_wrap(~model, nrow = 3)
ggsave("./Res/init_200_stepsize_50_steps_40_lambda_kp1/log_stein_diff3.pdf",
width = 10, height = 6, scale = 0.8)
require(graphics)
m <- decompose(co2)
m$figure
plot(m)
install.packages("wavelet")
install.packages("wavelets")
?dwt
??dwt
library(wavelets)
X1 <- c(.2,-.4,-.6,-.5,-.8,-.4,-.9,0,-.2,.1,-.1,.1,.7,.9,0,.3)
wt <- dwt(X1, n.levels=3, boundary="reflection", fast=FALSE)
plot(wt)
